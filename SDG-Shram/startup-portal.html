<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDG-Shram | Investor Portal</title>
    <link rel="stylesheet" href="startup-portal-premium.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons (standard for SaaS) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .investor-badge-ready {
            background: #e0f2fe;
            color: #0369a1;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.65rem;
            font-weight: 800;
            text-transform: uppercase;
            display: inline-block;
            margin-left: 8px;
        }
    </style>
</head>

<body>
    <div class="portal-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="logo/logo.png" alt="SDG-Shram">
                <h2>SDG-Shram</h2>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-section="discover">
                    <i class="fas fa-th-large"></i>
                    <span>Discover</span>
                </a>
                <a href="#" class="nav-item" data-section="traction">
                    <i class="fas fa-chart-line"></i>
                    <span>Traction</span>
                </a>
                <a href="#" class="nav-item" data-section="portfolio">
                    <i class="fas fa-briefcase"></i>
                    <span>Portfolio</span>
                </a>
                <a href="#" class="nav-item" data-section="documents">
                    <i class="fas fa-file-contract"></i>
                    <span>Documents</span>
                </a>
                <a href="#" class="nav-item" data-section="analytics">
                    <i class="fas fa-users"></i>
                    <span>Analytics</span>
                </a>
                <div
                    style="margin-top: 20px; padding: 0 12px; font-size: 0.7rem; color: rgba(255,255,255,0.4); text-transform: uppercase; font-weight: 700;">
                    Settings</div>
                <a href="#" class="nav-item" data-section="preferences">
                    <i class="fas fa-cog"></i>
                    <span>Preferences</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="user-quick-profile">
                    <div class="user-avatar" id="sidebarInitial">U</div>
                    <div style="flex: 1; overflow: hidden;">
                        <div id="sidebarName"
                            style="font-size: 0.85rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                            User Name</div>
                        <div id="sidebarRole" style="font-size: 0.7rem; color: rgba(255,255,255,0.5);">Impact Investor
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Layout -->
        <main class="main-layout">
            <header class="topbar">
                <div class="search-container">
                    <i class="fas fa-search" style="color: var(--text-muted);"></i>
                    <input type="text" placeholder="Search by SDG, Startup Name, or Sector...">
                </div>

                <div class="topbar-actions">
                    <a href="projects.html"
                        style="color: var(--text-secondary); text-decoration: none; font-size: 0.9rem; font-weight: 500;">
                        <i class="fas fa-arrow-left"></i> Projects
                    </a>
                    <a href="upload-startup.html" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Post Project
                    </a>
                </div>
            </header>

            <div class="content-padding" id="mainContentArea">
                <!-- Content injected via JS -->
            </div>
        </main>
    </div>

    <script>
        // Check authentication
        const token = localStorage.getItem('token');
        const userStr = localStorage.getItem('user');

        if (!token || !userStr) {
            window.location.replace('login.html');
        }

        const user = JSON.parse(userStr);

        function getUserDisplayName(user) {
            switch (user.stakeholderType) {
                case 'individual': return user.individual?.fullName || 'User';
                case 'ngo': return user.ngo?.ngoName || 'NGO';
                case 'business': return user.business?.companyName || 'Business';
                case 'institution': return user.institution?.institutionName || 'Institution';
                default: return user.email?.split('@')[0] || 'User';
            }
        }

        const displayName = getUserDisplayName(user);
        const initial = displayName.charAt(0).toUpperCase();

        document.getElementById('sidebarInitial').textContent = initial;
        document.getElementById('sidebarName').textContent = displayName;
        document.getElementById('sidebarRole').textContent = user.stakeholderType || 'Impact Member';

        // Real-time Engine
        const RealTimePortal = {
            currentSection: 'discover',

            init() {
                this.renderSection('discover');
                this.setupNavigation();
                this.listenForDataChanges();
            },

            setupNavigation() {
                document.querySelectorAll('.nav-item[data-section]').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = item.getAttribute('data-section');
                        this.switchSection(section);
                    });
                });
            },

            switchSection(section) {
                this.currentSection = section;
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                const activeItem = document.querySelector(`.nav-item[data-section="${section}"]`);
                if (activeItem) activeItem.classList.add('active');
                this.renderSection(section);
            },

            renderSection(section) {
                const container = document.getElementById('mainContentArea');
                container.style.opacity = '0';

                setTimeout(() => {
                    switch (section) {
                        case 'discover': container.innerHTML = this.templates.discover(); break;
                        case 'traction': container.innerHTML = this.templates.traction(); break;
                        case 'portfolio': container.innerHTML = this.templates.portfolio(); break;
                        case 'documents': container.innerHTML = this.templates.documents(); break;
                        case 'analytics': container.innerHTML = this.templates.analytics(); break;
                        case 'preferences': container.innerHTML = this.templates.preferences(); break;
                    }
                    container.style.opacity = '1';
                    container.style.transition = 'opacity 0.3s ease';

                    if (section === 'discover') this.loadDiscoverData();
                }, 200);
            },

            listenForDataChanges() {
                window.addEventListener('storage', (e) => {
                    if (e.key === 'submittedStartups' && this.currentSection === 'discover') {
                        this.loadDiscoverData();
                    }
                });

                // Simulate "Live" updates every 15s
                setInterval(() => {
                    if (this.currentSection === 'discover') {
                        console.log('Syncing discover data live...');
                        this.loadDiscoverData();
                    }
                }, 15000);
            },

            loadDiscoverData() {
                const container = document.getElementById('dynamicStartupsContainer');
                if (!container) return;

                // Save scroll position
                const scrollPos = window.scrollY;

                container.innerHTML = '';
                const submittedStartups = JSON.parse(localStorage.getItem('submittedStartups') || '[]');

                // Default Startups
                const defaultStartups = [
                    {
                        name: 'EcoPulse Systems',
                        sdg: 'Goal 7: Affordable & Clean Energy',
                        problemStatement: 'Revolutionizing decentralized solar grids for rural communities.',
                        funding: 450000,
                        stage: 'Series A',
                        icon: 'âš¡',
                        ready: true,
                        interest: 8
                    },
                    {
                        name: 'AquaRescue AI',
                        sdg: 'Goal 13: Climate Action',
                        problemStatement: 'Detection of ocean plastic blooms using proprietary satellite AI.',
                        funding: 1200000,
                        stage: 'Seed',
                        icon: 'ðŸŒŠ',
                        ready: false,
                        interest: 15
                    }
                ];

                const allStartups = [...submittedStartups.map(s => ({ ...s, icon: 'ðŸš€', interest: 'New' })), ...defaultStartups];

                allStartups.forEach(startup => {
                    const item = document.createElement('div');
                    item.className = 'startup-item';
                    item.innerHTML = `
                        <div class="startup-icon">${startup.icon}</div>
                        <div class="startup-info-main">
                            <div class="sdg-tag ${startup.sdg.includes('7') ? 'sdg-7' : 'sdg-13'}">${startup.sdg}</div>
                            <div class="startup-name">${startup.name} ${startup.ready ? '<span class="investor-badge-ready">Ready</span>' : ''}</div>
                            <div class="startup-tagline">${startup.problemStatement}</div>
                            <div class="metrics-horizontal">
                                <div class="metric-box"><h5>Funding Goal</h5><div>$${parseInt(startup.funding).toLocaleString()}</div></div>
                                <div class="metric-box"><h5>Stage</h5><div>${startup.stage}</div></div>
                                <div class="metric-box"><h5>Status</h5><div>${startup.interest}</div></div>
                            </div>
                        </div>
                        <div class="startup-actions">
                            <div style="font-size: 0.75rem; color: var(--impact-green); font-weight: 700;">${startup.interest} ${typeof startup.interest === 'string' ? '' : 'Investors Interested'}</div>
                            <a href="startup-detail.html" class="btn btn-secondary">View Pitch</a>
                        </div>
                    `;
                    container.appendChild(item);
                });

                document.getElementById('totalOpps').textContent = `${allStartups.length} Active`;
            },

            templates: {
                discover: () => `
                    <div class="page-header">
                        <div>
                            <h1>Investment Opportunities</h1>
                            <p>Curated SDG-aligned startups matching your impact thesis.</p>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 0.75rem; color: var(--text-muted); font-weight: 600; text-transform: uppercase;">Portal Status</div>
                            <div style="color: var(--impact-green); font-weight: 700; display: flex; align-items: center; gap: 6px;">
                                <span style="width: 8px; height: 8px; background: var(--impact-green); border-radius: 50%;"></span>
                                Operational
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-content">
                        <div class="main-section">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">Featured Startups</div>
                                    <div class="filter-row" style="margin-bottom: 0;">
                                        <button class="filter-btn active">All Goals</button>
                                        <button class="filter-btn">Climate Action</button>
                                        <button class="filter-btn">Clean Energy</button>
                                    </div>
                                </div>
                                <div id="dynamicStartupsContainer"></div>
                            </div>
                        </div>

                        <aside class="side-panel">
                            <div class="card">
                                <h3 class="card-title" style="margin-bottom: 20px;">Platform Analytics</h3>
                                <div class="stats-group">
                                    <div class="stat-card-small"><h5>Total Opportunities</h5><div class="value" id="totalOpps">...</div></div>
                                    <div class="stat-card-small"><h5>Investor Network</h5><div class="value">340+ VCs</div></div>
                                    <div class="stat-card-small"><h5>Avg Impact ROI</h5><div class="value" style="color: var(--secondary);">18.4%</div></div>
                                </div>
                            </div>
                            <div class="card">
                                <h3 class="card-title" style="margin-bottom: 12px;">Investor Readiness</h3>
                                <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 20px;">Profile is <b>85% complete</b>. Verification unlocks access.</p>
                                <div style="height: 6px; background: #f1f5f9; border-radius: 3px; margin-bottom: 24px; overflow: hidden;">
                                    <div style="height: 100%; width: 85%; background: var(--secondary);"></div>
                                </div>
                                <button class="btn btn-primary" style="width: 100%;">Complete Verification</button>
                            </div>
                        </aside>
                    </div>
                `,
                traction: () => `
                    <div class="page-header">
                        <h1>Market Traction</h1>
                        <p>Real-time sector growth and funding flow monitoring.</p>
                    </div>
                    <div class="card">
                        <h3 class="card-title">Investment Volume (Quarterly)</h3>
                        <div style="height: 300px; display: flex; align-items: center; justify-content: center; background: #f8fafc; border: 1px dashed var(--border-color); border-radius: 12px; margin-top: 20px;">
                             <i class="fas fa-chart-line" style="font-size: 4rem; color: var(--secondary); opacity: 0.5;"></i>
                             <span style="margin-left: 20px; font-weight: 600; color: var(--text-secondary);">Live Tracking Enabled: $14.2M moved this week</span>
                        </div>
                        <div class="metrics-horizontal" style="margin-top: 30px; justify-content: space-around;">
                            <div class="metric-box"><h5>Hottest Sector</h5><div style="color: var(--impact-green);">Climate Tech</div></div>
                            <div class="metric-box"><h5>Avg Round Size</h5><div>$1.2M</div></div>
                            <div class="metric-box"><h5>Exit Velocity</h5><div>High</div></div>
                        </div>
                    </div>
                `,
                portfolio: () => `
                    <div class="page-header">
                        <h1>Your Portfolio</h1>
                        <p>Management of your active SDG-aligned capital deployments.</p>
                    </div>
                    <div class="card">
                         <div style="text-align: center; padding: 60px 0;">
                            <i class="fas fa-folder-open" style="font-size: 3rem; color: var(--text-muted);"></i>
                            <h3 style="margin-top: 20px;">No Active Investments Yet</h3>
                            <p style="color: var(--text-secondary);">Start exploring the <a href="#" onclick="RealTimePortal.switchSection('discover')">Discover</a> tab to build your impact portfolio.</p>
                         </div>
                    </div>
                `,
                documents: () => `
                    <div class="page-header">
                        <h1>Due Diligence Room</h1>
                        <p>Secure document repository for investment analysis.</p>
                    </div>
                    <div class="card">
                        <div class="card-header"><div class="card-title">Recent Uploads</div></div>
                        <div class="document-item" style="padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color);">
                            <span><i class="far fa-file-pdf" style="color: #ef4444; margin-right: 12px;"></i> Common_Impact_Framework.pdf</span>
                            <div style="display: flex; gap: 15px;">
                                <span style="font-size: 0.8rem; color: var(--text-muted);">2.1 MB</span>
                                <i class="fas fa-download" style="cursor: pointer;"></i>
                            </div>
                        </div>
                        <div class="document-item" style="padding: 15px; display: flex; justify-content: space-between; align-items: center;">
                            <span><i class="far fa-file-excel" style="color: #22c55e; margin-right: 12px;"></i> Market_Opportunities_2026.xlsx</span>
                            <div style="display: flex; gap: 15px;">
                                <span style="font-size: 0.8rem; color: var(--text-muted);">1.8 MB</span>
                                <i class="fas fa-download" style="cursor: pointer;"></i>
                            </div>
                        </div>
                    </div>
                `,
                analytics: () => `
                    <div class="page-header">
                        <h1>Impact Analytics</h1>
                        <p>Quantifying the environmental and social ROI of the platform.</p>
                    </div>
                    <div class="dashboard-content">
                        <div class="card">
                             <h3 class="card-title">CO2 Offset Cumulative</h3>
                             <div style="height: 200px; background: #f0fdf4; border-radius: 12px; margin-top: 15px; border: 1px solid #bbf7d0; display: flex; align-items: center; justify-content: center;">
                                <div style="text-align: center;">
                                    <div style="font-size: 3rem; font-weight: 800; color: var(--impact-green);">254,102</div>
                                    <div style="font-size: 0.9rem; font-weight: 700; color: var(--impact-green);">Metric Tons Offset To Date</div>
                                </div>
                             </div>
                        </div>
                        <div class="card">
                             <h3 class="card-title">SDG Coverage</h3>
                             <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px;">
                                <span class="sdg-tag sdg-7">Goal 7: 42%</span>
                                <span class="sdg-tag sdg-13">Goal 13: 31%</span>
                                <span class="sdg-tag sdg-6">Goal 6: 15%</span>
                                <span class="sdg-tag" style="background:#e2e8f0; color:#475569;">Other: 12%</span>
                             </div>
                        </div>
                    </div>
                `,
                preferences: () => `
                    <div class="page-header">
                        <h1>Preferences</h1>
                        <p>Customize your investment thesis and notification alerts.</p>
                    </div>
                    <div class="card" style="max-width: 600px;">
                        <div class="input-group" style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 700; margin-bottom: 8px;">Investment Thesis</label>
                            <textarea rows="4" style="width: 100%;" placeholder="Describe the types of impact startups you looking for..."></textarea>
                        </div>
                        <div class="input-group" style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 700; margin-bottom: 8px;">Currency</label>
                            <select style="width: 100%;"><option>USD ($)</option><option>EUR (â‚¬)</option><option>INR (â‚¹)</option></select>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; margin-top:20px;">
                            <input type="checkbox" style="width: auto;" checked>
                            <span style="font-size: 0.9rem;">Send real-time alerts for new matching startups</span>
                        </div>
                         <button class="btn btn-primary" style="margin-top: 30px;">Save Settings</button>
                    </div>
                `
            }
        };

        RealTimePortal.init();
    </script>
</body>

</html>